{"ast":null,"code":"//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { BIconTypeUnderline, BIconTypeStrikethrough, BIconInfo, BIconEyeSlashFill } from 'bootstrap-vue';\nimport PastPerformanceView from '@/components/PastPerformanceView';\nimport WorkoutView from '@/components/WorkoutView';\nimport HorseExtraView from '@/components/HorseExtraView';\nimport axios from 'axios';\nimport _ from 'underscore';\nexport default {\n  name: 'HorseView',\n  components: {\n    PastPerformanceView,\n    WorkoutView,\n    HorseExtraView,\n    BIconTypeUnderline,\n    BIconTypeStrikethrough,\n    BIconInfo,\n    BIconEyeSlashFill\n  },\n  props: ['race', 'hideML'],\n  data() {\n    return {\n      transProps: {\n        name: 'flip-list'\n      },\n      horseFields: [{\n        key: \"scratchButton\",\n        label: \"\"\n      }, {\n        key: \"programNumber\",\n        label: \"#\",\n        title: \"Program Number\"\n      }, {\n        key: \"selection\",\n        label: \"ABC\",\n        title: \"ABC Selection\"\n      }, {\n        key: \"bettingLine\",\n        label: \"FV\",\n        title: \"Betting Fair Value Line\"\n      }, {\n        key: \"mlodds\",\n        \"label\": \"ML\",\n        title: \"Morning Line Odds\",\n        sortable: true,\n        tdClass: \"text-center\"\n      }, {\n        key: \"name\"\n      }, {\n        key: \"daysSinceLastRace\",\n        label: \"l/r\",\n        title: \"Days Since Last Race\",\n        tdClass: this.highlightDaysSince\n      }, {\n        key: \"furlongDays\",\n        label: \"FD\",\n        title: \"Furlong Days (Average Furlongs worked or raced in the last 30 days)\",\n        formatter: this.format2Places,\n        sortable: true\n      }, {\n        key: \"basicFitness\",\n        label: \"Fit\",\n        title: \"Basic Fitness (Points based on 7 day intervals between last 3 works and 1 race)\",\n        sortable: true\n      }, {\n        key: \"style\",\n        label: \"Style\",\n        title: \"Run Style and Speed Points\",\n        tdClass: this.highlightPaceAdvantage\n      }, {\n        key: \"classRating\",\n        label: \"Class\",\n        title: \"Weighted Average Speed Par\",\n        formatter: this.format2Places,\n        sortable: true,\n        tdClass: this.highlightMax\n      }, {\n        key: \"averageCompetitiveLevel\",\n        title: \"Average Competitive Level (Weighted Average Speed Par where finish in the money or within 3 lengths)\",\n        label: \"ACL\",\n        formatter: this.format2Places,\n        sortable: true,\n        tdClass: this.highlightMax\n      }, {\n        key: \"speedRating\",\n        label: \"Speed\",\n        title: \"Weighted Average BRIS Speed Figure\",\n        formatter: this.format2Places,\n        sortable: true,\n        tdClass: this.highlightMax\n      }, {\n        key: \"arating\",\n        label: \"AR\",\n        title: \"A Rating\",\n        formatter: this.format2Places,\n        sortable: true,\n        tdClass: this.highlightMax\n      }, {\n        key: \"aratingForm\",\n        label: \"AR F\",\n        title: \"A Form Rating\",\n        formatter: this.format2Places,\n        sortable: true,\n        tdClass: this.highlightMax\n      }, {\n        key: \"aratingConnections\",\n        label: \"AR Co\",\n        title: \"A Connections Rating\",\n        formatter: this.format2Places,\n        sortable: true,\n        tdClass: this.highlightMax\n      }, {\n        key: \"e1Avg\",\n        label: \"E1\",\n        title: \"Average E1 Pace\",\n        formatter: this.formatInt,\n        sortable: true,\n        tdClass: this.highlightMax\n      }, {\n        key: \"e2Avg\",\n        label: \"E2\",\n        title: \"Average E2 Pace\",\n        formatter: this.formatInt,\n        sortable: true,\n        tdClass: this.highlightMax\n      }, {\n        key: \"turnTime\",\n        label: \"TT\",\n        title: \"Average Turn Time (E2-E1)\",\n        formatter: this.formatInt,\n        sortable: true,\n        tdClass: this.highlightMax\n      }, {\n        key: \"latePaceAvg\",\n        label: \"Late\",\n        title: \"Average Late Pace\",\n        formatter: this.formatInt,\n        sortable: true,\n        tdClass: this.highlightMax\n      }, {\n        key: \"combinedPaceAvg\",\n        label: \"Comb\",\n        title: \"Average Combined Pace (E2+Late)\",\n        formatter: this.format2Places,\n        sortable: true,\n        tdClass: this.highlightMax\n      }, {\n        key: \"classShift\",\n        label: \"cSh\",\n        title: \"Class Rating Shift (Par change from previous race)\",\n        formatter: this.format2Places,\n        sortable: true,\n        tdClass: this.highlightShift\n      }, {\n        key: \"purseShift\",\n        label: \"pSh\",\n        title: \"Purse Shift (change from previous race)\",\n        formatter: this.formatInt,\n        sortable: true,\n        tdClass: this.highlightShift\n      }, {\n        key: \"detailsButton\",\n        label: \"\"\n      }, {\n        key: \"_showDetails\",\n        thClass: 'd-none',\n        tdClass: 'd-none'\n      }],\n      trackConditions: [{\n        value: \"ft\",\n        text: \"Fast\"\n      }, {\n        value: \"my\",\n        text: \"Muddy\"\n      }, {\n        value: \"wf\",\n        text: \"Wet Fast\"\n      }, {\n        value: \"yl\",\n        text: \"Yielding\"\n      }, {\n        value: \"hy\",\n        text: \"Heavy\"\n      }, {\n        value: \"gd\",\n        text: \"Good\"\n      }, {\n        value: \"sy\",\n        text: \"Sloppy\"\n      }, {\n        value: \"fm\",\n        text: \"Firm\"\n      }, {\n        value: \"sf\",\n        text: \"Soft\"\n      }, {\n        value: \"sl\",\n        text: \"Slow\"\n      }],\n      selectionOptions: [\"A\", \"B\", \"C\", \"X\"],\n      bettingLineOptions: [{\n        value: 0,\n        text: \"99\"\n      }, {\n        value: 1,\n        text: \"Even\"\n      }, {\n        value: 1.2,\n        text: \"6/5\"\n      }, {\n        value: 1.4,\n        text: \"7/5\"\n      }, {\n        value: 1.5,\n        text: \"3/2\"\n      }, {\n        value: 1.6,\n        text: \"8/5\"\n      }, {\n        value: 1.8,\n        text: \"9/5\"\n      }, {\n        value: 2,\n        text: \"2\"\n      }, {\n        value: 2.5,\n        text: \"5/2\"\n      }, {\n        value: 3,\n        text: \"3\"\n      }, {\n        value: 3.5,\n        text: \"7/2\"\n      }, {\n        value: 4,\n        text: \"4\"\n      }, {\n        value: 4.5,\n        text: \"9/2\"\n      }, {\n        value: 5,\n        text: \"5\"\n      }, {\n        value: 6,\n        text: \"6\"\n      }],\n      validBettingLineCombinations: [[1, 5, 6], [1.2, 3.5, 6], [1.2, 4, 5], [1.2, 4, 6], [1.2, 4.5, 4.5], [1.2, 4.5, 5], [1.4, 3, 6], [1.4, 3.5, 4.5], [1.4, 3.5, 5], [1.4, 4, 4], [1.4, 4, 4.5], [1.5, 3, 6], [1.5, 3.5, 4.5], [1.5, 4, 4], [1.6, 2.5, 6], [1.6, 3, 4.5], [1.6, 3, 5], [1.6, 3.5, 4], [1.6, 6, 6, 6], [1.8, 2.5, 4.5], [1.8, 2.5, 5], [1.8, 3, 4], [1.8, 3.5, 3.5], [1.8, 4.5, 6, 6], [1.8, 5, 5, 6], [1.8, 5, 6, 6], [2, 2, 6], [2, 2.5, 4], [2, 2.5, 4.5], [2, 3, 3.5], [2, 4, 6, 6], [2, 4.5, 5, 6], [2, 5, 5, 6], [2.5, 2.5, 3], [2.5, 4, 6, 6], [2.5, 3.5, 5, 6], [2.5, 4, 5, 5], [2.5, 4.5, 5, 6], [3, 3, 5, 6], [3, 3.5, 4, 6], [3, 3.5, 4.5, 5], [3, 3.5, 4.5, 6], [3, 3.5, 5, 5], [3, 4, 4, 5], [3, 4, 4, 6], [3, 4, 4.5, 4.5], [3, 4, 4.5, 5], [3, 4.5, 4.5, 4.5], [3.5, 3.5, 3.5, 6], [3.5, 3.5, 4, 5], [3.5, 3.5, 4.5, 4.5], [3.5, 4, 4, 4.5], [4, 4, 4, 4]]\n    };\n  },\n  computed: {\n    bettingLines() {\n      return _.filter(_.pluck(this.race.horses, 'bettingLine'), function (l) {\n        return l > 0;\n      }).sort();\n    },\n    bettingPercentages() {\n      return _.map(this.bettingLines, function (l) {\n        return 1 / (l + 1) * 100;\n      });\n    },\n    contenderTotal() {\n      return _.reduce(this.bettingPercentages, function (memo, num) {\n        return memo + num;\n      }, 0);\n    },\n    matchingBettingLines() {\n      var bettingLines = this.bettingLines;\n      if (bettingLines.length == 0) return;\n      return _.filter(this.validBettingLineCombinations, function (c) {\n        var match = true;\n        for (var i = 0; i < bettingLines.length; i++) {\n          if (bettingLines[i] != c[i]) match = false;\n        }\n        return match;\n      });\n    },\n    bettingLinesInvalid() {\n      return this.contenderTotal <= 77.49 || this.contenderTotal >= 82.51;\n    }\n  },\n  methods: {\n    async toggleScratch(item) {\n      try {\n        await axios({\n          url: 'toggleScratch/' + this.race.raceNumber + '/' + item.programNumber,\n          method: 'GET',\n          baseURL: 'http://localhost:8080/jpp/rest/remote/'\n        });\n        item.scratchedFlag = !item.scratchedFlag;\n      } catch (err) {\n        console.log(err.response);\n      }\n    },\n    async toggleIgnored(item) {\n      try {\n        await axios({\n          url: 'toggleIgnored/' + this.race.raceNumber + '/' + item.programNumber + '/' + item.raceDate[0] + '/' + item.raceDate[1] + '/' + item.raceDate[2],\n          method: 'GET',\n          baseURL: 'http://localhost:8080/jpp/rest/remote/'\n        });\n        item.ignoredFlag = !item.ignoredFlag;\n        console.log(item);\n      } catch (err) {\n        console.log(err.response);\n      }\n    },\n    async toggleShowDetail(row) {\n      try {\n        row.toggleDetails();\n        await axios({\n          url: 'toggleShowDetail/' + this.race.raceNumber + '/' + row.item.programNumber,\n          method: 'GET',\n          baseURL: 'http://localhost:8080/jpp/rest/remote/'\n        });\n      } catch (err) {\n        console.log(err.response);\n      }\n    },\n    async updateSelection(horse) {\n      try {\n        const response = await axios({\n          url: 'setSelection/' + this.race.raceNumber + '/' + horse.programNumber + '/' + horse.selection,\n          method: 'GET',\n          baseURL: 'http://localhost:8080/jpp/rest/remote/'\n        });\n        this.$emit('selectionUpdate', response.data);\n      } catch (err) {\n        console.log(err.response);\n      }\n    },\n    async updateBettingLine(horse) {\n      try {\n        const response = await axios({\n          url: 'setBettingLine/' + this.race.raceNumber + '/' + horse.programNumber + '/' + horse.bettingLine,\n          method: 'GET',\n          baseURL: 'http://localhost:8080/jpp/rest/remote/'\n        });\n        this.$emit('bettingLineUpdate', response.data);\n      } catch (err) {\n        console.log(err.response);\n      }\n    },\n    rowClass(item, type) {\n      if (!item || type !== 'row') return;\n      if (item.scratchedFlag) return 'table-dark scratched';\n      if (item.selection == 'A') return 'aHorse';\n      if (item.selection == 'B') return 'bHorse';\n      if (item.selection == 'C') return 'cHorse';\n      return 'notScratched';\n    },\n    fractionString(decimal) {\n      switch (decimal) {\n        case 0.13:\n          return \"hd\";\n        case 0.25:\n          return \"&frac14;\";\n        case 0.5:\n          return \"&frac12;\";\n        case 0.75:\n          return \"&frac34;\";\n      }\n    },\n    convertOddsToFraction(odds) {\n      switch (odds) {\n        case 1:\n          return \"Even\";\n        case 1.2:\n          return \"6/5\";\n        case 1.4:\n          return \"7/5\";\n        case 1.5:\n          return \"3/2\";\n        case 1.6:\n          return \"8/5\";\n        case 1.8:\n          return \"9/5\";\n        case 2:\n          return \"2\";\n        case 2.5:\n          return \"5/2\";\n        case 3:\n          return \"3\";\n        case 3.5:\n          return \"7/2\";\n        case 4:\n          return \"4\";\n        case 4.5:\n          return \"9/2\";\n        case 5:\n          return \"5\";\n        case 6:\n          return \"6\";\n      }\n      return odds + \"\";\n    },\n    shortenJockeyName(value) {\n      return value.split(\" \")[0] + value.split(\" \")[1].charAt(0);\n    },\n    format2Places(amount) {\n      const formatter = new Intl.NumberFormat('en-US', {\n        // These options are needed to round to whole numbers if that's what you want.\n        minimumFractionDigits: 2,\n        // (this suffices for whole numbers, but will print 2500.10 as $2,500.1)\n        maximumFractionDigits: 2 // (causes 2500.99 to be printed as $2,501)\n      });\n\n      return formatter.format(amount);\n    },\n    formatInt(amount) {\n      const formatter = new Intl.NumberFormat('en-US', {\n        // These options are needed to round to whole numbers if that's what you want.\n        minimumFractionDigits: 0,\n        // (this suffices for whole numbers, but will print 2500.10 as $2,500.1)\n        maximumFractionDigits: 0 // (causes 2500.99 to be printed as $2,501)\n      });\n\n      return formatter.format(amount);\n    },\n    formatCurrency(amount) {\n      const formatter = new Intl.NumberFormat('en-US', {\n        style: 'currency',\n        currency: 'USD',\n        // These options are needed to round to whole numbers if that's what you want.\n        minimumFractionDigits: 0,\n        // (this suffices for whole numbers, but will print 2500.10 as $2,500.1)\n        maximumFractionDigits: 0 // (causes 2500.99 to be printed as $2,501)\n      });\n\n      return formatter.format(amount);\n    },\n    highlightMax(value, key) {\n      var values = _.pluck(_.reject(this.race.horses, function (h) {\n        return h.scratchedFlag;\n      }), key);\n      if (value == _.max(values)) {\n        return \"greenHighlight\";\n      }\n    },\n    highlightDaysSince(value) {\n      if (value > 180) return \"gt180\";\n      if (value > 90) return \"gt90\";\n      if (value > 45) return \"gt45\";\n    },\n    highlightDaysSincePP(value, key, item) {\n      if (item.daysSinceLastRace > 180) return \"gt180\";\n      if (item.daysSinceLastRace > 90) return \"gt90\";\n      if (item.daysSinceLastRace > 45) return \"gt45\";\n    },\n    highlightFinish(value, key, item) {\n      if (item.finishPosition == \"1\") return \"greenHighlight\";\n      if (item.finishPosition == \"2\" || item.finishPosition == \"3\") return \"lightGreenHighlight\";\n    },\n    highlightBeatenFavorite(value, key, item) {\n      if (item.favoriteFlag && item.finishPosition != \"1\") return \"yellowHighlight\";\n    },\n    highlightPurseShift(value, key, item) {\n      if (item.purse >= this.race.purse + 20000) return \"greenHighlight\";\n      if (item.purse > this.race.purse) return \"lightGreenHighlight\";\n      if (item.purse == this.race.purse) return \"\";\n      if (item.purse < this.race.purse - 10000) return \"yellowHighlight\";\n      if (item.purse < this.race.purse - 20000) return \"lightRedHighlight\";\n      if (item.purse < this.race.purse - 30000) return \"redHighlight\";\n    },\n    highlightSpeedInRange(value, key, item) {\n      if (item.brisspeedRating >= this.race.parSpeed) return \"greenHighlight\";\n      if (item.brisspeedRating >= this.race.parSpeed - 3) return \"lightGreenHighlight\";\n    },\n    highlightPaceAdvantage(value, key, item) {\n      if (_.contains(_.pluck(this.race.advantagedHorses, \"programNumber\"), item.programNumber)) return \"greenHighlight\";\n    },\n    highlightShift(value) {\n      if (value < 0) return \"greenHighlight\";\n      if (value > 0) return \"yellowHighlight\";\n    },\n    highlightSimilarSurfDist(value, key, item) {\n      if (this.race.surface.indexOf(\"TURF\") > -1 && !this.race.offTheTurfFlag) {\n        if (item.surface.indexOf(\"TURF\") > -1 && (this.race.trackCondition == \"fm\" && item.trackCondition == \"fm\" || this.race.trackCondition != \"fm\" && [\"tf\", \"gd\", \"gf\", \"hd\", \"yl\", \"sf\", \"hy\", \"sl\"].indexOf(item.trackCondition) > -1) && (this.race.furlongs < 8 && item.furlongs < 8 || this.race.furlongs >= 8 && item.furlongs >= 8)) return \"blueHighlight\";\n      } else {\n        if ((item.surface.indexOf(\"TURF\") == -1 || item.offTheTurfFlag) && (this.race.trackCondition == \"ft\" && item.trackCondition == \"ft\" || this.race.trackCondition != \"ft\" && [\"gd\", \"hy\", \"my\", \"sl\", \"sy\", \"wf\"].indexOf(item.trackCondition) > -1) && (this.race.furlongs < 8 && item.furlongs < 8 || this.race.furlongs >= 8 && item.furlongs >= 8)) return \"blueHighlight\";\n      }\n    },\n    alsoInRace(nameToMatch, row) {\n      var names = _.pluck(this.race.horses, \"name\");\n      if (names.indexOf(nameToMatch) > -1 && nameToMatch != row.name) return \"alsoInRace\";\n    }\n  }\n};","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoZA;AACA;AACA;AACA;AAEA;AACA;AAEA;EACAA;EACAC;IACAC;IAAAC;IAAAC;IAAAC;IAAAC;IAAAC;IAAAC;EACA;EACAC;EACAC;IACA;MACAC;QACAX;MACA;MACAY,cACA;QAAAC;QAAAC;MAAA,GACA;QAAAD;QAAAC;QAAAC;MAAA,GACA;QAAAF;QAAAC;QAAAC;MAAA,GACA;QAAAF;QAAAC;QAAAC;MAAA,GACA;QAAAF;QAAA;QAAAE;QAAAC;QAAAC;MAAA,GACA;QAAAJ;MAAA,GACA;QAAAA;QAAAC;QAAAC;QAAAE;MAAA,GACA;QAAAJ;QAAAC;QAAAC;QAAAG;QAAAF;MAAA,GACA;QAAAH;QAAAC;QAAAC;QAAAC;MAAA,GACA;QAAAH;QAAAC;QAAAC;QAAAE;MAAA,GACA;QAAAJ;QAAAC;QAAAC;QAAAG;QAAAF;QAAAC;MAAA,GACA;QAAAJ;QAAAE;QAAAD;QAAAI;QAAAF;QAAAC;MAAA,GACA;QAAAJ;QAAAC;QAAAC;QAAAG;QAAAF;QAAAC;MAAA,GACA;QAAAJ;QAAAC;QAAAC;QAAAG;QAAAF;QAAAC;MAAA,GACA;QAAAJ;QAAAC;QAAAC;QAAAG;QAAAF;QAAAC;MAAA,GACA;QAAAJ;QAAAC;QAAAC;QAAAG;QAAAF;QAAAC;MAAA,GACA;QAAAJ;QAAAC;QAAAC;QAAAG;QAAAF;QAAAC;MAAA,GACA;QAAAJ;QAAAC;QAAAC;QAAAG;QAAAF;QAAAC;MAAA,GACA;QAAAJ;QAAAC;QAAAC;QAAAG;QAAAF;QAAAC;MAAA,GACA;QAAAJ;QAAAC;QAAAC;QAAAG;QAAAF;QAAAC;MAAA,GACA;QAAAJ;QAAAC;QAAAC;QAAAG;QAAAF;QAAAC;MAAA,GACA;QAAAJ;QAAAC;QAAAC;QAAAG;QAAAF;QAAAC;MAAA,GACA;QAAAJ;QAAAC;QAAAC;QAAAG;QAAAF;QAAAC;MAAA,GACA;QAAAJ;QAAAC;MAAA,GACA;QAAAD;QAAAM;QAAAF;MAAA,EAEA;MACAG,kBACA;QAAAC;QAAAC;MAAA,GACA;QAAAD;QAAAC;MAAA,GACA;QAAAD;QAAAC;MAAA,GACA;QAAAD;QAAAC;MAAA,GACA;QAAAD;QAAAC;MAAA,GACA;QAAAD;QAAAC;MAAA,GACA;QAAAD;QAAAC;MAAA,GACA;QAAAD;QAAAC;MAAA,GACA;QAAAD;QAAAC;MAAA,GACA;QAAAD;QAAAC;MAAA,EACA;MACAC,mBACA,mBACA;MACAC,qBACA;QAAAH;QAAAC;MAAA,GACA;QAAAD;QAAAC;MAAA,GACA;QAAAD;QAAAC;MAAA,GACA;QAAAD;QAAAC;MAAA,GACA;QAAAD;QAAAC;MAAA,GACA;QAAAD;QAAAC;MAAA,GACA;QAAAD;QAAAC;MAAA,GACA;QAAAD;QAAAC;MAAA,GACA;QAAAD;QAAAC;MAAA,GACA;QAAAD;QAAAC;MAAA,GACA;QAAAD;QAAAC;MAAA,GACA;QAAAD;QAAAC;MAAA,GACA;QAAAD;QAAAC;MAAA,GACA;QAAAD;QAAAC;MAAA,GACA;QAAAD;QAAAC;MAAA,EACA;MACAG,+BACA,WACA,yEACA,yEACA,2CACA,0EACA,gHACA,gGACA,mFACA,oKACA,8EACA;IAEA;EACA;EACAC;IACAC;MACA;QACA;MACA;IACA;IACAC;MACA;QACA;MACA;IACA;IACAC;MACA;QAAA;MAAA;IACA;IACAC;MACA;MACA;MACA;QACA;QACA;UACA;QACA;QACA;MACA;IAEA;IACAC;MACA;IACA;EACA;EACAC;IACA;MACA;QACA;UACAC;UACAC;UACAC;QACA;QACAC;MACA;QACAC;MAEA;IACA;IACA;MACA;QACA;UACAJ;UACAC;UACAC;QACA;QACAC;QACAC;MACA;QACAA;MAEA;IACA;IACA;MACA;QACAC;QACA;UACAL;UACAC;UACAC;QACA;MACA;QACAE;MAEA;IACA;IACA;MACA;QACA;UACAJ;UACAC;UACAC;QACA;QACA;MACA;QACAE;MAEA;IACA;IACA;MACA;QACA;UACAJ;UACAC;UACAC;QACA;QACA;MACA;QACAE;MAEA;IACA;IACAE;MACA;MACA;MACA;MACA;MACA;MACA;IACA;IACAC;MACA;QACA;UACA;QACA;UACA;QACA;UACA;QACA;UACA;MAAA;IAEA;IACAC;MACA;QACA;UAAA;QACA;UAAA;QACA;UAAA;QACA;UAAA;QACA;UAAA;QACA;UAAA;QACA;UAAA;QACA;UAAA;QACA;UAAA;QACA;UAAA;QACA;UAAA;QACA;UAAA;QACA;UAAA;QACA;UAAA;MAAA;MAEA;IACA;IACAC;MACA;IACA;IACAC;MACA;QAGA;QACAC;QAAA;QACAC;MACA;;MACA;IACA;IACAC;MACA;QAGA;QACAF;QAAA;QACAC;MACA;;MACA;IACA;IACAE;MACA;QACAC;QACAC;QAEA;QACAL;QAAA;QACAC;MACA;;MACA;IACA;IACAK;MACA;QACA;MACA;MAEA;QACA;MACA;IACA;IACAC;MACA;MACA;MACA;IACA;IACAC;MACA;MACA;MACA;IACA;IACAC;MACA;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;MACA;MACA;MACA;MACA;MACA;IACA;IACAC;MACA;MACA;IACA;IACAC;MACA;IACA;IACAC;MACA;MACA;IACA;IACAC;MACA;QACA,IACAvB,sCACA,+LACA,+FACA;MACA;QACA,oEACA,mLACA,+FACA;MACA;IACA;IACAwB;MACA;MACA;IAEA;EACA;AAEA","names":["name","components","PastPerformanceView","WorkoutView","HorseExtraView","BIconTypeUnderline","BIconTypeStrikethrough","BIconInfo","BIconEyeSlashFill","props","data","transProps","horseFields","key","label","title","sortable","tdClass","formatter","thClass","trackConditions","value","text","selectionOptions","bettingLineOptions","validBettingLineCombinations","computed","bettingLines","bettingPercentages","contenderTotal","matchingBettingLines","bettingLinesInvalid","methods","url","method","baseURL","item","console","row","rowClass","fractionString","convertOddsToFraction","shortenJockeyName","format2Places","minimumFractionDigits","maximumFractionDigits","formatInt","formatCurrency","style","currency","highlightMax","highlightDaysSince","highlightDaysSincePP","highlightFinish","highlightBeatenFavorite","highlightPurseShift","highlightSpeedInRange","highlightPaceAdvantage","highlightShift","highlightSimilarSurfDist","alsoInRace"],"sourceRoot":"src/components","sources":["HorseView.vue"],"sourcesContent":["<template>\n    <b-table\n        id=\"pps\"\n        :items=\"race.horses\"\n        :fields=\"horseFields\"\n        small\n        sort-icon-left\n        sort-desc\n        :tbody-tr-class=\"rowClass\"\n        primary-key=\"programNumber\"\n        :tbody-transition-props=\"transProps\"\n    >\n        <template #head()=\"data\">\n            <span v-b-tooltip.hover :title=\"data.field.title\">{{ data.label }}</span>\n        </template>    \n        <template #cell(style)=\"data\">\n            {{ data.item.runStyle }} {{ data.item.speedPoints }}\n        </template>\t\n        <template #cell(scratchButton)=\"row\">\t\n            <span v-if=\"!row.item.scratchedFlag\">\t\t\t\n                <b-button\n                    @click=\"toggleScratch(row.item)\"\n                    size=\"sm\"\n                    variant=\"warning\"\n                    class=\"mr-1\"\n                    title=\"S\">\n                    <b-icon-type-strikethrough\n                        aria-hidden=\"true\">\n                    ></b-icon-type-strikethrough>\n                </b-button>\n            </span>\n            <span v-if=\"row.item.scratchedFlag\">\t\t\t\n                <b-button\n                    @click=\"toggleScratch(row.item)\"\n                    size=\"sm\"\n                    variant=\"primary\"\n                    class=\"mr-1\"\n                    title=\"S\">\n                    <b-icon-type-underline\n                        aria-hidden=\"true\">\n                    ></b-icon-type-underline>\n                </b-button>\n            </span>\t\n        </template>\t\n        <template #cell(selection)=\"row\">\n            <b-form-select v-model=\"row.item.selection\" :options=\"selectionOptions\" @change=\"updateSelection(row.item)\"></b-form-select>\n        </template>\n        <template #cell(bettingLine)=\"row\">\n            <b-form-select \n                :id=\"'bettingLine'+row.item.programNumber\"\n                v-model=\"row.item.bettingLine\" \n                :options=\"bettingLineOptions\" \n                @change=\"updateBettingLine(row.item)\" \n                :state=\"row.item.bettingLine == 0 ? null : (bettingLinesInvalid ? false : true)\"\n            ></b-form-select>\n            <b-tooltip  v-if=\"row.item.bettingLine == 0 && bettingLinesInvalid\" :target=\"'bettingLine'+row.item.programNumber\" placement=\"right\">\n                <span v-for=\"(bettingLine,key) in matchingBettingLines\" :key=\"key\">\n                    <span v-for=\"(odds, oddsKey) in bettingLine\" :key=\"oddsKey\">\n                        {{convertOddsToFraction(odds)}} <span v-if=\"oddsKey < bettingLine.length - 1\">-</span>\n                    </span>\n                    <br>\n                </span>\n            </b-tooltip> \n        </template>\n        <template #cell(mlodds)=\"row\">        \n                <span class=\"text-danger\" v-if=\"hideML\"><b-icon-eye-slash-fill></b-icon-eye-slash-fill></span>\n                <span v-else>{{row.item.mlodds}}</span>\n        </template>        \n        <template #cell(detailsButton)=\"row\">\t\t\t\t\n            <b-button\n                @click=\"toggleShowDetail(row)\"\n                size=\"sm\"\n                variant=\"outline-primary\"\n                class=\"mr-1\"\n                title=\"S\">\n                <b-icon-info\n                    aria-hidden=\"true\">\n                ></b-icon-info>\n            </b-button>\n        </template>\t\n        <template #row-details=\"row\">\n            <b-container fluid class=\"pp border\">\n                <b-row>\n                    <b-col cols=\"4\">\n                        <b-row>\n                            <b-col cols=\"1\">\n                                <span class=\"h5\"><strong>{{row.item.programNumber}}</strong>\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n                                </span><br>\n                                <span class=\"h6\"><span class=\"text-danger\" v-if=\"hideML\"><b-icon-eye-slash-fill></b-icon-eye-slash-fill></span>\n                <span v-else>{{row.item.mlodds}}</span></span><br>\n                            </b-col>\n                            <b-col>\n                                <span class=\"h5\"><strong>{{row.item.name}} ({{row.item.runStyle}} {{row.item.speedPoints}})</strong>&nbsp;\n                                    <span style=\"float:right;\">\n                                        <span v-if=\"row.item.claimingPrice\">{{formatCurrency(row.item.claimingPrice)}}<br></span>\n                                        <b-badge class=\"text-right\" v-if=\"row.item.mtoflag == 'M'\" variant=\"dark\">MTO</b-badge>\n                                        <b-badge v-if=\"row.item.mtoflag == 'A'\" variant=\"dark\">AE</b-badge>\n                                    </span>\n                                </span>\n                                <br>\n                                <strong>Own: {{row.item.owner}}</strong><br>\n                                {{row.item.ownerSilks}}\n                            </b-col>\n                        </b-row>\n                    </b-col>\n                    <b-col cols=\"3\">\n                        <strong>\n                            {{row.item.color}}. {{row.item.sex}}. {{row.item.age}} ({{row.item.foalingMonth}})  {{row.item.auctionLocationDate}}  <span :class=\"row.item.auctionPrice > 100000 && row.item.lifetimeWins == 0 ? 'greenHighlight' : ''\">{{formatCurrency(row.item.auctionPrice)}}</span><br>\n                            <b-row>\n                                <b-col cols=\"2\">\n                                    Sire :\n                                </b-col>\n                                <b-col>\n                                    {{row.item.sire}} ({{row.item.siresSire}}) {{formatCurrency(row.item.sireStudFee)}}<br>\n                                </b-col>\n                            </b-row>\n                            <b-row>\n                                <b-col cols=\"2\">\n                                    Dam  :  \n                                </b-col>\n                                <b-col>\n                                    {{row.item.dam}} ({{row.item.damsSire}})<br>\n                                </b-col>\n                            </b-row>\n                            <b-row>\n                                <b-col cols=\"2\">\n                                    Brdr :  \n                                </b-col>\n                                <b-col>\n                                    {{row.item.breeder}}<br>\n                                </b-col>\n                            </b-row>\n                            <b-row>\n                                <b-col cols=\"2\">\n                                    Trnr :  \n                                </b-col>\n                                <b-col :class=\"(row.item.trainer.currentMeetStarts == 0 ? 0 : (row.item.trainer.currentMeetWins/row.item.trainer.currentMeetStarts*100) > 20 && row.item.trainer.currentMeetStarts > 20) ? 'greenHighlight' : ''\">\n                                    {{row.item.trainer.name}}  ({{row.item.trainer.currentMeetStarts}} {{row.item.trainer.currentMeetWins}}-{{row.item.trainer.currentMeetPlaces}}-{{row.item.trainer.currentYearShows}} {{row.item.trainer.currentMeetStarts == 0 ? 0 : (row.item.trainer.currentMeetWins/row.item.trainer.currentMeetStarts*100).toFixed(0)}}%)\n                                </b-col>\n                            </b-row>\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t \n                        </strong>\n                    </b-col>\n                    <b-col cols=\"1\" class=\"text-right\">\n                        <br><br><strong>{{row.item.weight}}</strong>\n                    </b-col>\n                    <b-col cols=\"4\">\n                        <b-row>\n                            <b-col cols=\"5\" class=\"border-right\">\n                                <b-row class=\"border-left border-bottom\">\n                                    <b-col cols=\"2\">\n                                        <strong>Life:</strong>  \n                                    </b-col>\n                                    <b-col cols=\"5\">\n                                        {{row.item.lifetimeStarts}}&nbsp;&nbsp;{{row.item.lifetimeWins}}-{{row.item.lifetimePlaces}}-{{row.item.lifetimeShows}}<br>\n                                    </b-col>\n                                    <b-col cols=\"3\">\n                                        {{formatCurrency(row.item.lifetimeEarnings)}}\n                                    </b-col>\n                                    <b-col cols=\"2\">\n                                        <strong>{{row.item.lifetimeBestSpeed}}</strong>\n                                    </b-col>\n                                </b-row>\t\t\t\t\t\t\t\t\t\t\t\t\t\n                                <b-row>\n                                    <b-col cols=\"2\">\n                                        <strong>{{row.item.currentYear}}</strong> \n                                    </b-col>\n                                    <b-col cols=\"5\">\n                                        {{row.item.currentYearStarts}}&nbsp;&nbsp;{{row.item.currentYearWins}}-{{row.item.currentYearPlaces}}-{{row.item.currentYearShows}}<br>\n                                    </b-col>\n                                    <b-col cols=\"3\">\n                                        {{formatCurrency(row.item.currentYearEarnings)}}\n                                    </b-col>\n                                    <b-col cols=\"2\">\n                                        <strong>{{row.item.currentYearBestSpeed}}</strong>\n                                    </b-col>\t\t\t\t\t\t\t\t\t\t\n                                </b-row>\t\n                                <b-row>\n                                    <b-col cols=\"2\">\n                                        <strong>{{row.item.previousYear}}</strong>  \n                                    </b-col>\n                                    <b-col cols=\"5\">\n                                        {{row.item.previousYearStarts}}&nbsp;&nbsp;{{row.item.previousYearWins}}-{{row.item.previousYearPlaces}}-{{row.item.previousYearShows}}<br>\n                                    </b-col>\n                                    <b-col cols=\"3\">\n                                        {{formatCurrency(row.item.previousYearEarnings)}}\n                                    </b-col>\n                                    <b-col cols=\"2\">\n                                        <strong>{{row.item.previousYearBestSpeed}}</strong>\n                                    </b-col>\t\t\t\t\t\t\t\t\t\t\t\t\t\n                                </b-row>\t\n                                <b-row>\n                                    <b-col cols=\"2\">\n                                        <strong>{{row.item.currentTrack}}</strong> \n                                    </b-col>\n                                    <b-col cols=\"5\" :class=\"row.item.trackWins > 0 || row.item.trackPlaces > 2 ? 'greenHighlight' : ''\">\n                                        {{row.item.trackStarts}}&nbsp;&nbsp;{{row.item.trackWins}}-{{row.item.trackPlaces}}-{{row.item.trackShows}}<br>\n                                    </b-col>\n                                    <b-col cols=\"3\">\n                                        {{formatCurrency(row.item.trackEarnings)}}\n                                    </b-col>\n                                    <b-col cols=\"2\">\n                                        <strong>{{row.item.trackBestSpeed}}</strong>\n                                    </b-col>\t\t\t\t\t\t\t\t\t\t\t\t\t\n                                </b-row>\n                            </b-col>\n                            <b-col cols=\"7\">\n                                <b-row>\n                                    <b-col cols=\"4\">\n                                        <strong>Fst <span v-if=\"row.item.pedigreeRatingDirt\">({{row.item.pedigreeRatingDirt}})</span></strong>  \n                                    </b-col>\n                                    <b-col cols=\"3\">\n                                        {{row.item.dirtStarts}}&nbsp;{{row.item.dirtWins}}-{{row.item.dirtPlaces}}-{{row.item.dirtShows}}<br>\n                                    </b-col>\n                                    <b-col cols=\"3\">\n                                        {{formatCurrency(row.item.dirtEarnings)}}\n                                    </b-col>\n                                    <b-col cols=\"1\">\n                                        <strong>{{row.item.dirtBestSpeed}}</strong>\n                                    </b-col>\n                                </b-row>\t\t\t\t\t\t\t\t\t\t\t\t\t\n                                <b-row>\n                                    <b-col cols=\"4\" >\n                                        <strong>Off <span v-if=\"row.item.pedigreeRatingMud\">({{row.item.pedigreeRatingMud}})</span></strong> \n                                    </b-col>\n                                    <b-col cols=\"3\" :class=\"race.trackCondition != 'ft' && race.trackCondition != 'fm' && (row.item.wetWins > 0 || row.item.wetPlaces > 2) ? 'greenHighlight' : ''\">\n                                        {{row.item.wetStarts}}&nbsp;{{row.item.wetWins}}-{{row.item.wetPlaces}}-{{row.item.wetShows}}<br>\n                                    </b-col>\n                                    <b-col cols=\"3\">\n                                        {{formatCurrency(row.item.wetEarnings)}}\n                                    </b-col>\n                                    <b-col cols=\"1\">\n                                        <strong>{{row.item.wetBestSpeed}}</strong>\n                                    </b-col>\t\t\t\t\t\t\t\t\t\t\n                                </b-row>\t\n                                <b-row>\n                                    <b-col cols=\"4\">\n                                        <strong>Dis  <span v-if=\"row.item.pedigreeRatingDist\">({{row.item.pedigreeRatingDist}})</span></strong>  \n                                    </b-col>\n                                    <b-col cols=\"3\">\n                                        {{row.item.distanceStarts}}&nbsp;{{row.item.distanceWins}}-{{row.item.distancePlaces}}-{{row.item.distanceShows}}<br>\n                                    </b-col>\n                                    <b-col cols=\"3\">\n                                        {{formatCurrency(row.item.distanceEarnings)}}\n                                    </b-col>\n                                    <b-col cols=\"1\">\n                                        <strong>{{row.item.distanceBestSpeed}}</strong>\n                                    </b-col>\t\t\t\t\t\t\t\t\t\t\t\t\t\n                                </b-row>\t\n                                <b-row>\n                                    <b-col cols=\"4\">\n                                        <strong>Trf  <span v-if=\"row.item.pedigreeRatingTurf\">({{row.item.pedigreeRatingTurf}})</span></strong> \n                                    </b-col>\n                                    <b-col cols=\"3\">\n                                        {{row.item.turfStarts}}&nbsp;{{row.item.turfWins}}-{{row.item.turfPlaces}}-{{row.item.turfShows}}<br>\n                                    </b-col>\n                                    <b-col cols=\"3\">\n                                        {{formatCurrency(row.item.turfEarnings)}}\n                                    </b-col>\n                                    <b-col cols=\"1\">\n                                        <strong>{{row.item.turfBestSpeed}}</strong>\n                                    </b-col>\t\t\t\t\t\t\t\t\t\t\t\t\t\n                                </b-row>\n                                <b-row>\n                                    <b-col cols=\"4\">\n                                        <strong>AW</strong> \n                                    </b-col>\n                                    <b-col cols=\"3\">\n                                        {{row.item.allWeatherStarts}}&nbsp;{{row.item.allWeatherWins}}-{{row.item.allWeatherPlaces}}-{{row.item.allWeatherShows}}<br>\n                                    </b-col>\n                                    <b-col cols=\"3\">\n                                        {{formatCurrency(row.item.allWeatherEarnings)}}\n                                    </b-col>\n                                    <b-col cols=\"1\">\n                                        <strong>{{row.item.allWeatherBestSpeed}}</strong>\n                                    </b-col>\t\t\t\t\t\t\t\t\t\t\t\t\t\n                                </b-row>\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n                            </b-col>\n                            <b-col>\n\n                            </b-col>\n                        </b-row>\n                    </b-col>\n\n                </b-row>\n                <b-row>\n                    <b-col :class=\"(row.item.jockey.currentMeetStarts == 0 ? 0 : (row.item.jockey.currentMeetWins/row.item.jockey.currentMeetStarts*100) > 20 && row.item.jockey.currentMeetStarts > 20) ? 'greenHighlight' : ''\">\n                        {{row.item.jockey.name}} ({{row.item.jockey.currentMeetStarts}} {{row.item.jockey.currentMeetWins}}-{{row.item.jockey.currentMeetPlaces}}-{{row.item.jockey.currentMeetShows}} {{row.item.jockey.currentMeetStarts == 0 ? 0 : (row.item.jockey.currentMeetWins/row.item.jockey.currentMeetStarts*100).toFixed(0)}}%)<br>\n                    </b-col>\n                </b-row>\n                <b-row>\n                    <b-col cols=\"3\">\n                        <b-row>\n                            <b-col cols=\"4\">\n                                {{row.item.currentYear}}\n                            </b-col>\n                            <b-col cols=\"2\">\n                                {{row.item.jockey.currentYearStarts}}\n                            </b-col>\n                            <b-col :class=\"row.item.jockey.currentYearStarts > 20 && row.item.trainer.currentYearWins/row.item.jockey.currentYearStarts*100 > 20 ? 'greenHighlight' : ''\">\n                                {{row.item.jockey.currentYearStarts == 0 ? 0 : (row.item.jockey.currentYearWins/row.item.jockey.currentYearStarts*100).toFixed(0)}}%\n                            </b-col>\n                            <b-col>\n                                {{row.item.jockey.currentYearStarts == 0 ? 0 : ((row.item.jockey.currentYearWins + row.item.jockey.currentYearPlaces + row.item.jockey.currentYearShows)/row.item.jockey.currentYearStarts*100).toFixed(0)}}%\n                            </b-col>\n                            <b-col>\n                                {{row.item.jockey.currentYearROI}}\n                            </b-col>\t\t\t\t\t\t\t\t\t\t\t\n                        </b-row>\t\t\t\t\t\t\t\t\t\t\t\n                        <b-row>\n                            <b-col cols=\"4\">\n                                {{row.item.previousYear}}\n                            </b-col>\n                            <b-col cols=\"2\">\n                                {{row.item.jockey.previousYearStarts}}\n                            </b-col>\n                            <b-col>\n                                {{row.item.jockey.previousYearStarts == 0 ? 0 : (row.item.jockey.previousYearWins/row.item.jockey.previousYearStarts*100).toFixed(0)}}%\n                            </b-col>\n                            <b-col>\n                                {{row.item.jockey.previousYearStarts == 0 ? 0 : ((row.item.jockey.previousYearWins + row.item.jockey.previousYearPlaces + row.item.jockey.previousYearShows)/row.item.jockey.previousYearStarts*100).toFixed(0)}}%\n                            </b-col>\n                            <b-col>\n                                {{row.item.jockey.previousYearROI}}\n                            </b-col>\t\t\t\t\t\t\t\t\t\t\t\n                        </b-row>\n                        <b-row v-for=\"stat in row.item.jockey.stats\" :key=\"stat.category\">\n                            <b-col cols=\"4\">\n                                JKYw/ {{stat.category}}\n                            </b-col>\n                            <b-col cols=\"2\">\n                                {{stat.starts}}\n                            </b-col>\n                            <b-col>\n                                {{stat.starts == 0 ? 0 : (stat.wins / stat.starts * 100).toFixed(0)}}%\n                            </b-col>\n                            <b-col>\n                                {{stat.starts == 0 ? 0 : ((stat.wins + stat.places + stat.shows)/ stat.starts * 100).toFixed(0)}}%\n                            </b-col>\n                            <b-col>\n                                {{stat.roi}}\n                            </b-col>\t\t\t\t\t\t\t\t\t\t\t\n                        </b-row>\t\n                        <b-row v-if=\"row.item.pastPerformances.length > 2\" class=\"my-2\">\n                            <b-col>\n                                <b-button class=\"ml-auto\" size=\"sm\" v-b-toggle=\"'extra-'+race.raceNumber+'-'+row.index\" variant=\"primary\">Trends</b-button>\n                            </b-col>\n                        </b-row>                       \t\t\t\t\t\t\t\t\t\n                    </b-col>\n                    <b-col cols=\"3\" offset=\"1\">\n                        <b-row>\n                            <b-col cols=\"4\">\n                                {{row.item.currentYear}}\n                            </b-col>\n                            <b-col cols=\"2\">\n                                {{row.item.trainer.currentYearStarts}}\n                            </b-col>\n                            <b-col :class=\"row.item.trainer.currentYearStarts > 20 && row.item.trainer.currentYearWins/row.item.trainer.currentYearStarts*100 > 20 ? 'greenHighlight' : ''\">\n                                {{row.item.trainer.currentYearStarts == 0 ? 0 : (row.item.trainer.currentYearWins/row.item.trainer.currentYearStarts*100).toFixed(0)}}%\n                            </b-col>\n                            <b-col>\n                                {{row.item.trainer.currentYearStarts == 0 ? 0 : ((row.item.trainer.currentYearWins + row.item.trainer.currentYearPlaces + row.item.trainer.currentYearShows)/row.item.trainer.currentYearStarts*100).toFixed(0)}}%\n                            </b-col>\n                            <b-col>\n                                {{row.item.trainer.currentYearROI}}\n                            </b-col>\t\t\t\t\t\t\t\t\t\t\t\n                        </b-row>\t\t\t\t\t\t\t\t\t\t\t\n                        <b-row v-for=\"stat in row.item.trainer.trainerStats\" :key=\"stat.category\">\n                            <b-col cols=\"4\">\n                                {{stat.category}}\n                            </b-col>\n                            <b-col cols=\"2\">\n                                {{stat.starts}}\n                            </b-col>\n                            <b-col :class=\"stat.winPercent > 20 ? 'greenHighlight' : ''\">\n                                {{stat.winPercent.toFixed(0)}}%\n                            </b-col>\n                            <b-col>\n                                {{stat.itmpercent.toFixed(0)}}%\n                            </b-col>\n                            <b-col>\n                                {{stat.roi.toFixed(2)}}\n                            </b-col>\t\t\t\t\t\t\t\t\t\t\t\n                        </b-row>\t\n                    </b-col>\n                    <b-col>\n                        <b-row v-for=\"(angle,ndx) in row.item.angles\" :key=\"ndx\">\n                            <span :class=\"'font-weight-bold ' + (angle.charAt(0) == '+' ? 'text-success' : (angle.charAt(0) == '-' ? 'text-danger' : 'text-warning'))\">{{angle.substring(1)}}</span>\n                        </b-row>\n                    </b-col>\n                </b-row>     \n                <b-collapse :id=\"'extra-'+race.raceNumber+'-'+row.index\" class=\"mt-2\">\n                    <horse-extra-view :horse=\"row.item\"></horse-extra-view>\n                </b-collapse>               \n                <past-performance-view :horse=\"row.item\" :race=\"race\"></past-performance-view>\n                <span v-for=\"workout in row.item.workouts\" :key=\"workout.date\">\n                    <workout-view :workout=\"workout\"></workout-view>\n                </span>\t\t\t\t\t\t\t\t\t\t\n            </b-container>\n        </template>\t\t\t\t\t\t\t\t\t\t\t\n    </b-table>\n\n</template>\n\n<script>\nimport { BIconTypeUnderline, BIconTypeStrikethrough, BIconInfo, BIconEyeSlashFill } from 'bootstrap-vue'\nimport PastPerformanceView from '@/components/PastPerformanceView'\nimport WorkoutView from '@/components/WorkoutView'\nimport HorseExtraView from '@/components/HorseExtraView'\n\nimport axios from 'axios'\nimport _ from 'underscore'\n\nexport default {\n    name: 'HorseView',\n    components: {\n\t\tPastPerformanceView, WorkoutView, HorseExtraView, BIconTypeUnderline, BIconTypeStrikethrough, BIconInfo, BIconEyeSlashFill\n    },\n    props : ['race', 'hideML'],\n    data () {\n\t\treturn {\n            transProps: {\n\t\t\t\tname: 'flip-list'\n\t\t\t},\n\t\t\thorseFields: [\n\t\t\t\t{key: \"scratchButton\", label:\"\"},\n\t\t\t\t{key: \"programNumber\", label:\"#\", title: \"Program Number\"},\n                {key: \"selection\", label: \"ABC\", title: \"ABC Selection\"},\n                {key: \"bettingLine\", label: \"FV\", title: \"Betting Fair Value Line\"},                \n\t\t\t\t{key: \"mlodds\", \"label\": \"ML\", title: \"Morning Line Odds\", sortable:true, tdClass: \"text-center\"},\n\t\t\t\t{key: \"name\"},\n\t\t\t\t{key: \"daysSinceLastRace\", label:\"l/r\", title: \"Days Since Last Race\", tdClass: this.highlightDaysSince},\n\t\t\t\t{key: \"furlongDays\", label: \"FD\", title: \"Furlong Days (Average Furlongs worked or raced in the last 30 days)\", formatter: this.format2Places, sortable: true},\n                {key: \"basicFitness\", label: \"Fit\", title: \"Basic Fitness (Points based on 7 day intervals between last 3 works and 1 race)\", sortable: true},\n\t\t\t\t{key: \"style\", label: \"Style\", title: \"Run Style and Speed Points\", tdClass: this.highlightPaceAdvantage },\n\t\t\t\t{key: \"classRating\", label:\"Class\", title: \"Weighted Average Speed Par\", formatter: this.format2Places, sortable: true, tdClass: this.highlightMax},\n\t\t\t\t{key: \"averageCompetitiveLevel\", title: \"Average Competitive Level (Weighted Average Speed Par where finish in the money or within 3 lengths)\", label:\"ACL\", formatter: this.format2Places, sortable: true, tdClass: this.highlightMax},\n\t\t\t\t{key: \"speedRating\", label:\"Speed\", title: \"Weighted Average BRIS Speed Figure\", formatter: this.format2Places, sortable: true, tdClass: this.highlightMax},\n\t\t\t\t{key: \"arating\", label: \"AR\", title: \"A Rating\", formatter: this.format2Places, sortable: true, tdClass: this.highlightMax},\n\t\t\t\t{key: \"aratingForm\", label:\"AR F\", title: \"A Form Rating\", formatter: this.format2Places, sortable: true, tdClass: this.highlightMax}, \n\t\t\t\t{key: \"aratingConnections\", label:\"AR Co\", title: \"A Connections Rating\", formatter: this.format2Places, sortable: true, tdClass: this.highlightMax},\n\t\t\t\t{key: \"e1Avg\", label:\"E1\", title: \"Average E1 Pace\", formatter: this.formatInt, sortable: true, tdClass: this.highlightMax},\n\t\t\t\t{key: \"e2Avg\", label:\"E2\", title: \"Average E2 Pace\", formatter: this.formatInt, sortable: true, tdClass: this.highlightMax},\n\t\t\t\t{key: \"turnTime\", label:\"TT\", title: \"Average Turn Time (E2-E1)\", formatter: this.formatInt, sortable: true, tdClass: this.highlightMax},\n\t\t\t\t{key: \"latePaceAvg\", label:\"Late\", title: \"Average Late Pace\", formatter: this.formatInt, sortable: true, tdClass: this.highlightMax},\n\t\t\t\t{key: \"combinedPaceAvg\", label:\"Comb\", title: \"Average Combined Pace (E2+Late)\", formatter: this.format2Places, sortable: true, tdClass: this.highlightMax},\n\t\t\t\t{key: \"classShift\", label:\"cSh\", title: \"Class Rating Shift (Par change from previous race)\", formatter: this.format2Places, sortable: true, tdClass: this.highlightShift},\n\t\t\t\t{key: \"purseShift\", label:\"pSh\", title: \"Purse Shift (change from previous race)\", formatter: this.formatInt, sortable: true, tdClass: this.highlightShift},\n\t\t\t\t{key: \"detailsButton\", label:\"\"},\n\t\t\t\t{key: \"_showDetails\", thClass: 'd-none', tdClass: 'd-none' }\n\n\t\t\t],\n\t\t\ttrackConditions: [\n\t\t\t\t{value: \"ft\", text: \"Fast\"},\n\t\t\t\t{value: \"my\", text: \"Muddy\"},\n\t\t\t\t{value: \"wf\", text: \"Wet Fast\"},\n\t\t\t\t{value: \"yl\", text: \"Yielding\"},\n\t\t\t\t{value: \"hy\", text: \"Heavy\"},\n\t\t\t\t{value: \"gd\", text: \"Good\"},\n\t\t\t\t{value: \"sy\", text: \"Sloppy\"},\n\t\t\t\t{value: \"fm\", text: \"Firm\"},\n\t\t\t\t{value: \"sf\", text: \"Soft\"},\n\t\t\t\t{value: \"sl\", text: \"Slow\"}\n\t\t\t],\n            selectionOptions : [\n                \"A\",\"B\",\"C\",\"X\"\n            ],\n            bettingLineOptions : [\n                {value: 0, text: \"99\"},\n                {value: 1, text: \"Even\"},\n                {value: 1.2, text: \"6/5\"},\n                {value: 1.4, text: \"7/5\"},\n                {value: 1.5, text: \"3/2\"},\n                {value: 1.6, text: \"8/5\"},\n                {value: 1.8, text: \"9/5\"},\n                {value: 2, text: \"2\"},\n                {value: 2.5, text: \"5/2\"},\n                {value: 3, text: \"3\"},\n                {value: 3.5, text: \"7/2\"},\n                {value: 4, text: \"4\"},\n                {value: 4.5, text: \"9/2\"},\n                {value: 5, text: \"5\"},\n                {value: 6, text: \"6\"},\n            ],\n            validBettingLineCombinations: [\n                [1,5,6],\n                [1.2,3.5,6],[1.2,4,5],[1.2,4,6],[1.2,4.5,4.5],[1.2,4.5,5],\n                [1.4,3,6],[1.4,3.5,4.5],[1.4,3.5,5],[1.4,4,4],[1.4,4,4.5],\n                [1.5,3,6],[1.5,3.5,4.5],[1.5,4,4],\n                [1.6,2.5,6],[1.6,3,4.5],[1.6,3,5],[1.6,3.5,4],[1.6,6,6,6],\n                [1.8,2.5,4.5],[1.8,2.5,5],[1.8,3,4],[1.8,3.5,3.5],[1.8,4.5,6,6],[1.8,5,5,6],[1.8,5,6,6],\n                [2,2,6],[2,2.5,4],[2,2.5,4.5],[2,3,3.5],[2,4,6,6],[2,4.5,5,6],[2,5,5,6],\n                [2.5,2.5,3],[2.5,4,6,6],[2.5,3.5,5,6],[2.5,4,5,5],[2.5,4.5,5,6],\n                [3,3,5,6],[3,3.5,4,6],[3,3.5,4.5,5],[3,3.5,4.5,6],[3,3.5,5,5],[3,4,4,5],[3,4,4,6],[3,4,4.5,4.5],[3,4,4.5,5],[3,4.5,4.5,4.5],\n                [3.5,3.5,3.5,6],[3.5,3.5,4,5],[3.5,3.5,4.5,4.5],[3.5,4,4,4.5],\n                [4,4,4,4]\n            ]\n        }\n    },\n    computed: {\n        bettingLines () {\n            return _.filter(_.pluck(this.race.horses, 'bettingLine'), function(l) {\n                return l > 0;\n            }).sort();\n        },\n        bettingPercentages () {\n            return _.map(this.bettingLines, function(l){\n                return 1/(l+1) * 100;\n            })\n        },\n        contenderTotal () {\n            return _.reduce(this.bettingPercentages, function(memo, num){ return memo + num; }, 0)\n        },\n        matchingBettingLines () {\n            var bettingLines = this.bettingLines;\n            if (bettingLines.length == 0) return;\n            return _.filter(this.validBettingLineCombinations, function(c){\n                var match = true;\n                for (var i = 0; i < bettingLines.length; i++) {\n                    if (bettingLines[i] != c[i]) match = false;\n                }\n                return match;\n            });\n\n        },\n        bettingLinesInvalid () {\n            return this.contenderTotal <= 77.49 || this.contenderTotal >= 82.51;\n        }\n    },\n    methods:  {\n\t\tasync toggleScratch(item) {\n            try {\n                await axios({\n                    url: 'toggleScratch/' + this.race.raceNumber + '/' + item.programNumber,\n                    method: 'GET',\n                    baseURL: 'http://localhost:8080/jpp/rest/remote/'\n                });\n                item.scratchedFlag = !item.scratchedFlag;\n            } catch (err) {\n                console.log(err.response);\n                \n            }\n\t\t},\n\t\tasync toggleIgnored(item) {\n            try {\n                await axios({\n                    url: 'toggleIgnored/' + this.race.raceNumber + '/' + item.programNumber + '/' + item.raceDate[0] + '/' + item.raceDate[1] + '/' + item.raceDate[2],\n                    method: 'GET',\n                    baseURL: 'http://localhost:8080/jpp/rest/remote/'\n                });\n                item.ignoredFlag = !item.ignoredFlag;\n\t\t\t\tconsole.log(item);\n            } catch (err) {\n                console.log(err.response);\n                \n            }\n\t\t},\t\t\n        async toggleShowDetail(row) {\n            try {\n                row.toggleDetails();\n                await axios({\n                    url: 'toggleShowDetail/' + this.race.raceNumber + '/' + row.item.programNumber,\n                    method: 'GET',\n                    baseURL: 'http://localhost:8080/jpp/rest/remote/'\n                });\n            } catch (err) {\n                console.log(err.response);\n                \n            }               \n        },\n        async updateSelection(horse) {\n            try {\n                const response = await axios({\n                    url: 'setSelection/' + this.race.raceNumber + '/' + horse.programNumber + '/' + horse.selection ,\n                    method: 'GET',\n                    baseURL: 'http://localhost:8080/jpp/rest/remote/'\n                });\n                this.$emit('selectionUpdate', response.data);\n            } catch (err) {\n                console.log(err.response);\n                \n            }               \n        },       \n        async updateBettingLine(horse) {\n            try {\n                const response = await axios({\n                    url: 'setBettingLine/' + this.race.raceNumber + '/' + horse.programNumber + '/' + horse.bettingLine ,\n                    method: 'GET',\n                    baseURL: 'http://localhost:8080/jpp/rest/remote/'\n                });\n                this.$emit('bettingLineUpdate', response.data);\n            } catch (err) {\n                console.log(err.response);\n                \n            }  \n        },\n\t\trowClass(item, type) {\n\t\t\tif (!item || type !== 'row') return;\n\t\t\tif (item.scratchedFlag) return 'table-dark scratched';\n            if (item.selection  == 'A') return 'aHorse';\n            if (item.selection  == 'B') return 'bHorse';\n            if (item.selection  == 'C') return 'cHorse';\n\t\t\treturn 'notScratched';\n\t\t},\t\t\n\t\tfractionString(decimal) {\n\t\t\tswitch(decimal) {\n\t\t\t\tcase 0.13:\n\t\t\t\t\treturn \"hd\";\n\t\t\t\tcase 0.25:\n\t\t\t\t\treturn \"&frac14;\";\n\t\t\t\tcase 0.5:\n\t\t\t\t\treturn \"&frac12;\";\n\t\t\t\tcase 0.75:\n\t\t\t\t\treturn \"&frac34;\";\n\t\t\t}\n\t\t},\n        convertOddsToFraction(odds) {\n            switch (odds) {\n                case 1: return \"Even\";\n                case 1.2 : return \"6/5\";\n                case 1.4 : return \"7/5\";\n                case 1.5 : return \"3/2\";\n                case 1.6 : return \"8/5\";\n                case 1.8 : return \"9/5\";\n                case 2 : return \"2\";\n                case 2.5 : return \"5/2\";\n                case 3 : return \"3\";\n                case 3.5 : return \"7/2\";\n                case 4 : return \"4\";\n                case 4.5 : return \"9/2\";\n                case 5 : return \"5\";\n                case 6 : return \"6\";\n            }\n            return odds + \"\";\n        },\n\t\tshortenJockeyName(value) {\n\t\t\treturn value.split(\" \")[0] + value.split(\" \")[1].charAt(0);\n\t\t},\n\t\tformat2Places(amount) {\n\t\t\tconst formatter = new Intl.NumberFormat('en-US', {\n\n\n\t\t\t\t// These options are needed to round to whole numbers if that's what you want.\n\t\t\t\tminimumFractionDigits: 2, // (this suffices for whole numbers, but will print 2500.10 as $2,500.1)\n\t\t\t\tmaximumFractionDigits: 2, // (causes 2500.99 to be printed as $2,501)\n\t\t\t});\n\t\t\treturn formatter.format(amount);\n\t\t}  ,\n\t\tformatInt(amount) {\n\t\t\tconst formatter = new Intl.NumberFormat('en-US', {\n\n\n\t\t\t\t// These options are needed to round to whole numbers if that's what you want.\n\t\t\t\tminimumFractionDigits: 0, // (this suffices for whole numbers, but will print 2500.10 as $2,500.1)\n\t\t\t\tmaximumFractionDigits: 0, // (causes 2500.99 to be printed as $2,501)\n\t\t\t});\n\t\t\treturn formatter.format(amount);\n\t\t},\n\t\tformatCurrency(amount) {\n\t\t\tconst formatter = new Intl.NumberFormat('en-US', {\n\t\t\t\tstyle: 'currency',\n\t\t\t\tcurrency: 'USD',\n\n\t\t\t\t// These options are needed to round to whole numbers if that's what you want.\n\t\t\t\tminimumFractionDigits: 0, // (this suffices for whole numbers, but will print 2500.10 as $2,500.1)\n\t\t\t\tmaximumFractionDigits: 0, // (causes 2500.99 to be printed as $2,501)\n\t\t\t});\n\t\t\treturn formatter.format(amount);\n\t\t},\t\n\t\thighlightMax(value, key) {\n\t\t\tvar values = _.pluck(_.reject(this.race.horses, function(h) {\n\t\t\t\treturn h.scratchedFlag;\n\t\t\t}), key);\n\n\t\t\tif (value == _.max(values)) {\n\t\t\t\treturn \"greenHighlight\";\n\t\t\t}\n\t\t},\n\t\thighlightDaysSince(value) {\n\t\t\tif (value  > 180) return \"gt180\";\n\t\t\tif (value > 90) return \"gt90\";\n\t\t\tif (value > 45) return \"gt45\";\n\t\t},\n\t\thighlightDaysSincePP(value, key , item) {\n\t\t\tif (item.daysSinceLastRace  > 180) return \"gt180\";\n\t\t\tif (item.daysSinceLastRace > 90) return \"gt90\";\n\t\t\tif (item.daysSinceLastRace > 45) return \"gt45\";\n\t\t},\t\n\t\thighlightFinish(value, key, item) {\n\t\t\tif (item.finishPosition == \"1\") return \"greenHighlight\";\n\t\t\tif (item.finishPosition == \"2\" || item.finishPosition == \"3\") return \"lightGreenHighlight\";\n\t\t},\t\n\t\thighlightBeatenFavorite(value,key,item) {\n\t\t\tif (item.favoriteFlag && item.finishPosition != \"1\") return \"yellowHighlight\";\n\t\t},\n\t\thighlightPurseShift(value,key,item) {\n\t\t\tif (item.purse >= this.race.purse + 20000 ) return \"greenHighlight\";\n\t\t\tif (item.purse > this.race.purse) return \"lightGreenHighlight\";\n\t\t\tif (item.purse == this.race.purse) return \"\";\n\t\t\tif (item.purse < this.race.purse - 10000) return \"yellowHighlight\";\n\t\t\tif (item.purse < this.race.purse - 20000) return \"lightRedHighlight\";\n\t\t\tif (item.purse < this.race.purse - 30000) return \"redHighlight\";\n\t\t},\n\t\thighlightSpeedInRange(value,key,item) {\n\t\t\tif (item.brisspeedRating >= this.race.parSpeed) return \"greenHighlight\";\n\t\t\tif (item.brisspeedRating >= this.race.parSpeed - 3) return \"lightGreenHighlight\";\n\t\t},\n\t\thighlightPaceAdvantage(value, key, item) {\n\t\t\tif (_.contains(_.pluck(this.race.advantagedHorses,\"programNumber\"), item.programNumber)) return \"greenHighlight\";\n\t\t},\n\t\thighlightShift(value) {\n\t\t\tif (value < 0) return \"greenHighlight\";\n\t\t\tif (value > 0) return \"yellowHighlight\";\n\t\t},\n\t\thighlightSimilarSurfDist(value, key, item) {\n\t\t\tif (this.race.surface.indexOf(\"TURF\") > -1 && !this.race.offTheTurfFlag) {\n\t\t\t\tif (\n\t\t\t\t\titem.surface.indexOf(\"TURF\") > -1 \n\t\t\t\t\t&& ((this.race.trackCondition == \"fm\" && item.trackCondition == \"fm\") || (this.race.trackCondition != \"fm\" && [\"tf\",\"gd\",\"gf\",\"hd\",\"yl\",\"sf\",\"hy\",\"sl\"].indexOf(item.trackCondition) > -1))\n\t\t\t\t\t&& ((this.race.furlongs < 8 && item.furlongs < 8) || (this.race.furlongs >= 8 && item.furlongs >= 8))) \n\t\t\t\t\treturn \"blueHighlight\";\n\t\t\t} else {\n\t\t\t\tif ((item.surface.indexOf(\"TURF\") == -1 || item.offTheTurfFlag)\n\t\t\t\t\t&& ((this.race.trackCondition == \"ft\" && item.trackCondition == \"ft\") || (this.race.trackCondition != \"ft\" && [\"gd\",\"hy\",\"my\",\"sl\",\"sy\",\"wf\"].indexOf(item.trackCondition) > -1))\n\t\t\t\t\t&& ((this.race.furlongs < 8 && item.furlongs < 8) || (this.race.furlongs >= 8 && item.furlongs >= 8))) \n\t\t\t\t\treturn \"blueHighlight\";\n\t\t\t}\n\t\t},\n\t\talsoInRace(nameToMatch, row) {\n\t\t\tvar names = _.pluck(this.race.horses, \"name\");\n\t\t\tif (names.indexOf(nameToMatch) > -1 && nameToMatch != row.name) return \"alsoInRace\";\n\n\t\t},\n    }\n\n}\n</script>\n\n\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}